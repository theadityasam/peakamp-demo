---
//Import relevant dependencies
import ThemeIcon from "@components/ThemeIcon.astro";
import NavLink from "@components/ui/links/NavLink.astro";
import MegaMenuLink from "@components/ui/links/MegaMenuLink.astro";
import Authentication from "../misc/Authentication.astro";
import enStrings from "@utils/navigation.ts";
import frStrings from "@utils/fr/navigation.ts";
import BrandLogo from "@components/BrandLogo.astro";
import LanguagePicker from "@components/ui/LanguagePicker.astro";

// Select the correct translation based on the page's lang prop:
const strings = Astro.currentLocale === "fr" ? frStrings : enStrings;
const homeUrl = Astro.currentLocale === "fr" ? "/fr" : `${Astro.site}`;

---

<!-- Main header component -->
<header
  class="sticky inset-x-0 top-4 z-50 flex w-full flex-wrap text-sm md:flex-nowrap md:justify-start"
>
  <!-- Navigation container -->
  <nav
    class="relative mx-2 w-full rounded-[36px] border border-green-100/40 bg-green-50/60 px-4 py-3 backdrop-blur-md dark:border-neutral-700/40 dark:bg-neutral-800/80 dark:backdrop-blur-md md:flex md:items-center md:justify-between md:px-6 md:py-0 lg:px-8 xl:mx-auto"
    aria-label="Global"
  >
    <div class="flex items-center justify-between">
      <!-- Brand logo -->
      <a
        class="flex-none rounded-lg text-xl font-bold outline-none ring-zinc-500 focus-visible:ring dark:ring-zinc-200 dark:focus:outline-none"
        href={homeUrl}
        aria-label="Brand"
      >
        <BrandLogo class="h-auto w-24" />
      </a>
      <!-- Collapse toggle for smaller screens -->
      <div class="ml-auto mr-5 md:hidden">
        <button
          type="button"
          class="hs-collapse-toggle flex h-8 w-8 items-center justify-center rounded-full text-sm font-bold text-neutral-600 transition duration-300 hover:bg-neutral-200 disabled:pointer-events-none disabled:opacity-50 dark:text-neutral-400 dark:hover:bg-neutral-700 dark:focus:outline-none"
          data-hs-collapse="#navbar-collapse-with-animation"
          aria-controls="navbar-collapse-with-animation"
          aria-label="Toggle navigation"
        >
          <svg
            class="h-[1.25rem] w-[1.25rem] flex-shrink-0 hs-collapse-open:hidden"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <line x1="3" x2="21" y1="6" y2="6"></line>
            <line x1="3" x2="21" y1="12" y2="12"></line>
            <line x1="3" x2="21" y1="18" y2="18"></line>
          </svg>
          <svg
            class="hidden h-[1.25rem] w-[1.25rem] flex-shrink-0 hs-collapse-open:block"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <path d="M18 6 6 18"></path>
            <path d="m6 6 12 12"></path>
          </svg>
          <!-- Peakamp logo -->
          <!-- <svg width="2335" height="779" viewBox="0 0 2335 779" fill="none" xmlns="http://www.w3.org/2000/svg">
            <g clip-path="url(#clip0_9_2)">
            <path d="M36 610V237.5H88V297.5L80 293C82 283 87.6667 273.5 97 264.5C106.333 255.167 117.667 247.667 131 242C144.667 236 158.667 233 173 233C196.667 233 217.667 238.833 236 250.5C254.333 262.167 268.833 278.167 279.5 298.5C290.167 318.833 295.5 342.167 295.5 368.5C295.5 394.5 290.167 417.833 279.5 438.5C269.167 458.833 254.833 475 236.5 487C218.167 498.667 197.5 504.5 174.5 504.5C159.167 504.5 144.333 501.5 130 495.5C115.667 489.167 103.5 481.167 93.5 471.5C83.5 461.833 77.3333 451.833 75 441.5L88 434.5V610H36ZM166 457C181.333 457 195 453.167 207 445.5C219 437.833 228.5 427.333 235.5 414C242.5 400.667 246 385.5 246 368.5C246 351.5 242.5 336.5 235.5 323.5C228.833 310.167 219.5 299.667 207.5 292C195.5 284.333 181.667 280.5 166 280.5C150.333 280.5 136.5 284.333 124.5 292C112.5 299.333 103 309.667 96 323C89 336.333 85.5 351.5 85.5 368.5C85.5 385.5 89 400.667 96 414C103 427.333 112.5 437.833 124.5 445.5C136.5 453.167 150.333 457 166 457ZM473.93 505C446.93 505 422.93 499.333 401.93 488C381.263 476.333 364.93 460.5 352.93 440.5C341.263 420.5 335.43 397.5 335.43 371.5C335.43 350.833 338.763 332 345.43 315C352.096 298 361.263 283.333 372.93 271C384.93 258.333 399.096 248.667 415.43 242C432.096 235 450.096 231.5 469.43 231.5C486.43 231.5 502.263 234.833 516.93 241.5C531.596 247.833 544.263 256.667 554.93 268C565.93 279.333 574.263 292.833 579.93 308.5C585.93 323.833 588.763 340.667 588.43 359L587.93 381H373.43L361.93 340H543.43L535.93 348.5V336.5C534.93 325.5 531.263 315.667 524.93 307C518.596 298.333 510.596 291.5 500.93 286.5C491.263 281.5 480.763 279 469.43 279C451.43 279 436.263 282.5 423.93 289.5C411.596 296.167 402.263 306.167 395.93 319.5C389.596 332.5 386.43 348.667 386.43 368C386.43 386.333 390.263 402.333 397.93 416C405.596 429.333 416.43 439.667 430.43 447C444.43 454.333 460.596 458 478.93 458C491.93 458 503.93 455.833 514.93 451.5C526.263 447.167 538.43 439.333 551.43 428L577.43 464.5C569.43 472.5 559.596 479.5 547.93 485.5C536.596 491.5 524.43 496.333 511.43 500C498.763 503.333 486.263 505 473.93 505ZM745.398 505C723.732 505 703.898 499 685.898 487C668.232 475 654.065 458.667 643.398 438C632.732 417.333 627.398 394 627.398 368C627.398 341.667 632.732 318.333 643.398 298C654.398 277.333 669.065 261.167 687.398 249.5C706.065 237.833 726.898 232 749.898 232C763.565 232 776.065 234 787.398 238C798.732 242 808.565 247.667 816.898 255C825.565 262 832.565 270.167 837.898 279.5C843.565 288.833 847.065 298.833 848.398 309.5L836.898 305.5V237.5H888.898V500H836.898V437.5L848.898 434C846.898 443 842.732 451.833 836.398 460.5C830.398 468.833 822.565 476.333 812.898 483C803.565 489.667 793.065 495 781.398 499C770.065 503 758.065 505 745.398 505ZM758.898 457.5C774.565 457.5 788.398 453.667 800.398 446C812.398 438.333 821.732 427.833 828.398 414.5C835.398 400.833 838.898 385.333 838.898 368C838.898 351 835.398 335.833 828.398 322.5C821.732 309.167 812.398 298.667 800.398 291C788.398 283.333 774.565 279.5 758.898 279.5C743.565 279.5 729.898 283.333 717.898 291C706.232 298.667 696.898 309.167 689.898 322.5C683.232 335.833 679.898 351 679.898 368C679.898 385.333 683.232 400.833 689.898 414.5C696.898 427.833 706.232 438.333 717.898 446C729.898 453.667 743.565 457.5 758.898 457.5ZM1007.8 418L1005.3 362L1130.8 237.5H1200.3L1007.8 418ZM960.805 500V130H1012.3V500H960.805ZM1137.8 500L1038.8 384.5L1075.3 351L1203.8 500H1137.8Z" fill="#073B4C"/>
            <path d="M1221.48 500L1356.98 150H1411.98L1546.48 500H1488.98L1408.98 289C1407.98 286.667 1405.98 281 1402.98 272C1400.32 263 1397.15 253 1393.48 242C1389.82 231 1386.48 221 1383.48 212C1380.48 202.667 1378.48 196.667 1377.48 194L1388.98 193.5C1386.98 199.167 1384.48 206.333 1381.48 215C1378.82 223.667 1375.82 232.833 1372.48 242.5C1369.48 252.167 1366.48 261.333 1363.48 270C1360.48 278.333 1357.98 285.333 1355.98 291L1276.48 500H1221.48ZM1281.48 413L1301.48 361H1460.48L1483.48 413H1281.48ZM1594.08 500V237.5H1646.08V293.5L1636.58 299.5C1639.25 290.833 1643.42 282.5 1649.08 274.5C1655.08 266.5 1662.25 259.5 1670.58 253.5C1679.25 247.167 1688.42 242.167 1698.08 238.5C1708.08 234.833 1718.25 233 1728.58 233C1743.58 233 1756.75 235.5 1768.08 240.5C1779.42 245.5 1788.75 253 1796.08 263C1803.42 273 1808.75 285.5 1812.08 300.5L1804.08 298.5L1807.58 290C1811.25 282.333 1816.25 275.167 1822.58 268.5C1829.25 261.5 1836.75 255.333 1845.08 250C1853.42 244.667 1862.25 240.5 1871.58 237.5C1880.92 234.5 1890.08 233 1899.08 233C1918.75 233 1934.92 237 1947.58 245C1960.58 253 1970.25 265.167 1976.58 281.5C1983.25 297.833 1986.58 318.167 1986.58 342.5V500H1934.58V345.5C1934.58 330.5 1932.58 318.333 1928.58 309C1924.92 299.333 1919.25 292.167 1911.58 287.5C1903.92 282.833 1894.08 280.5 1882.08 280.5C1872.75 280.5 1863.92 282.167 1855.58 285.5C1847.58 288.5 1840.58 292.833 1834.58 298.5C1828.58 304.167 1823.92 310.833 1820.58 318.5C1817.25 325.833 1815.58 334 1815.58 343V500H1763.58V344.5C1763.58 330.833 1761.58 319.333 1757.58 310C1753.58 300.333 1747.75 293 1740.08 288C1732.42 283 1723.08 280.5 1712.08 280.5C1702.75 280.5 1694.08 282.167 1686.08 285.5C1678.08 288.5 1671.08 292.833 1665.08 298.5C1659.08 303.833 1654.42 310.333 1651.08 318C1647.75 325.333 1646.08 333.333 1646.08 342V500H1594.08ZM2055.53 610V237.5H2107.53V297.5L2099.53 293C2101.53 283 2107.2 273.5 2116.53 264.5C2125.86 255.167 2137.2 247.667 2150.53 242C2164.2 236 2178.2 233 2192.53 233C2216.2 233 2237.2 238.833 2255.53 250.5C2273.86 262.167 2288.36 278.167 2299.03 298.5C2309.7 318.833 2315.03 342.167 2315.03 368.5C2315.03 394.5 2309.7 417.833 2299.03 438.5C2288.7 458.833 2274.36 475 2256.03 487C2237.7 498.667 2217.03 504.5 2194.03 504.5C2178.7 504.5 2163.86 501.5 2149.53 495.5C2135.2 489.167 2123.03 481.167 2113.03 471.5C2103.03 461.833 2096.86 451.833 2094.53 441.5L2107.53 434.5V610H2055.53ZM2185.53 457C2200.86 457 2214.53 453.167 2226.53 445.5C2238.53 437.833 2248.03 427.333 2255.03 414C2262.03 400.667 2265.53 385.5 2265.53 368.5C2265.53 351.5 2262.03 336.5 2255.03 323.5C2248.36 310.167 2239.03 299.667 2227.03 292C2215.03 284.333 2201.2 280.5 2185.53 280.5C2169.86 280.5 2156.03 284.333 2144.03 292C2132.03 299.333 2122.53 309.667 2115.53 323C2108.53 336.333 2105.03 351.5 2105.03 368.5C2105.03 385.5 2108.53 400.667 2115.53 414C2122.53 427.333 2132.03 437.833 2144.03 445.5C2156.03 453.167 2169.86 457 2185.53 457Z" fill="#15CB9E"/>
            <rect width="1130" height="63" rx="31.5" transform="matrix(1 0 0 -1 1205 779)" fill="#15CB9E"/>
            </g>
            <defs>
            <clipPath id="clip0_9_2">
            <rect width="2335" height="779" fill="white"/>
            </clipPath>
            </defs>
          </svg> -->
            
        </button>
      </div>
      <!-- ThemeIcon component specifically for smaller screens -->
      <span class="inline-block md:hidden">
        <ThemeIcon />
      </span>
    </div>
    <!-- Contains navigation links -->
    <div
      id="navbar-collapse-with-animation"
      class="hs-collapse hidden grow basis-full overflow-hidden transition-all duration-300 md:block"
    >
      <!-- Navigation links container -->
      <div
        class="mt-5 flex flex-col gap-x-0 gap-y-4 md:mt-0 md:flex-row md:items-center md:justify-end md:gap-x-4 md:gap-y-0 md:ps-7 lg:gap-x-7"
      >
        <!-- Navigation links and Authentication component -->
        {
          strings.navBarLinks.map((link) => {
            if (link.name === "Services") {
              return <MegaMenuLink />;
            } else {
              return <NavLink url={`${Astro.site}${link.url}`} name={link.name} />;
            }
          })
        }

        <!-- <Authentication />
        <LanguagePicker /> -->
        <!-- ThemeIcon component specifically for larger screens -->
        <span class="hidden md:inline-block">
          <ThemeIcon />
        </span>
      </div>
    </div>
  </nav>
</header>
<!-- Theme Appearance script to manage light/dark modes -->
<script is:inline>
  const HSThemeAppearance = {
    init() {
      const defaultTheme = "default";
      let theme = localStorage.getItem("hs_theme") || defaultTheme;

      if (document.querySelector("html").classList.contains("dark")) return;
      this.setAppearance(theme);
    },
    _resetStylesOnLoad() {
      const $resetStyles = document.createElement("style");
      $resetStyles.innerText = `*{transition: unset !important;}`;
      $resetStyles.setAttribute("data-hs-appearance-onload-styles", "");
      document.head.appendChild($resetStyles);
      return $resetStyles;
    },
    setAppearance(theme, saveInStore = true, dispatchEvent = true) {
      const $resetStylesEl = this._resetStylesOnLoad();

      if (saveInStore) {
        localStorage.setItem("hs_theme", theme);
      }

      if (theme === "auto") {
        theme = window.matchMedia("(prefers-color-scheme: dark)").matches
          ? "dark"
          : "default";
      }

      document.querySelector("html").classList.remove("dark");
      document.querySelector("html").classList.remove("default");
      document.querySelector("html").classList.remove("auto");

      document
        .querySelector("html")
        .classList.add(this.getOriginalAppearance());

      setTimeout(() => {
        $resetStylesEl.remove();
      });

      if (dispatchEvent) {
        window.dispatchEvent(
          new CustomEvent("on-hs-appearance-change", { detail: theme })
        );
      }
    },
    getAppearance() {
      let theme = this.getOriginalAppearance();
      if (theme === "auto") {
        theme = window.matchMedia("(prefers-color-scheme: dark)").matches
          ? "dark"
          : "default";
      }
      return theme;
    },
    getOriginalAppearance() {
      const defaultTheme = "default";
      return localStorage.getItem("hs_theme") || defaultTheme;
    },
  };
  HSThemeAppearance.init();

  window
    .matchMedia("(prefers-color-scheme: dark)")
    .addEventListener("change", () => {
      if (HSThemeAppearance.getOriginalAppearance() === "auto") {
        HSThemeAppearance.setAppearance("auto", false);
      }
    });

  window.addEventListener("load", () => {
    const $clickableThemes = document.querySelectorAll(
      "[data-hs-theme-click-value]"
    );
    const $switchableThemes = document.querySelectorAll(
      "[data-hs-theme-switch]"
    );

    $clickableThemes.forEach(($item) => {
      $item.addEventListener("click", () =>
        HSThemeAppearance.setAppearance(
          $item.getAttribute("data-hs-theme-click-value"),
          true,
          $item
        )
      );
    });

    $switchableThemes.forEach(($item) => {
      $item.addEventListener("change", (e) => {
        HSThemeAppearance.setAppearance(e.target.checked ? "dark" : "default");
      });

      $item.checked = HSThemeAppearance.getAppearance() === "dark";
    });

    window.addEventListener("on-hs-appearance-change", (e) => {
      $switchableThemes.forEach(($item) => {
        $item.checked = e.detail === "dark";
      });
    });
  });
</script>
<!--Import the necessary Collapse and Overlay plugins-->
<!--https://preline.co/plugins/html/collapse.html-->
<!--https://preline.co/plugins/html/overlay.html-->
<!--https://preline.co/plugins/html/dropdown.html-->
<script>
  import "@preline/collapse/index.js";
  import "@preline/overlay/index.js";
  import "@preline/dropdown/index.js";
</script>
